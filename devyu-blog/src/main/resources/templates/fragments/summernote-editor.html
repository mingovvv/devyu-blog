<div th:fragment = "summernote-editor">
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.15/dist/summernote-bs4.min.js"></script>
<script type="text/javascript">
$('.note-editor .note-editable').css("line-height", '300px');
$('#summernote').summernote({
	minHeight: 500,             // set minimum height of editor
	maxHeight: 500,             // set maximum height of editor
	lang: 'ko-KR',
	callbacks:{
		onImageUpload : function(files) {
		      if (!files.length) return;
		      var file = files[0];
		      // create FileReader
		      var reader  = new FileReader();
		      reader.onloadend = function () {
		          // when loaded file, img's src set datauri
		          console.log("img",$("<img>"));
		          var img = $("<img>").attr({src: reader.result, width: "100%"}); // << Add here img attributes !
		          console.log("var img", img);
		          $("#summernote").summernote("insertNode", img[0]);
		      }

		      if (file) {
		        // convert fileObject to datauri
		        reader.readAsDataURL(file);
		      }
		      uploadImage(file);
		  }
	}
});

$('.note-editor .note-editable').css("line-height", 1);

function uploadImage(file) {
    var data = new FormData();
    data.append('file', file, file.name);

    $.ajax({
        method: 'POST',
        url: '/blog/imageUpload',
        contentType: false,
        cache: false,
        processData: false,
        data: data,
        success: function (img) {
            /* $('#summernote').summernote('insertImage', img); */
        },
        error: function (jqXHR, textStatus, errorThrown) {
            console.error(textStatus + " " + errorThrown);
        }
    });
};
</script>
</div>